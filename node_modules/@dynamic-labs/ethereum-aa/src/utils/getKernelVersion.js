'use client'
import { ENTRYPOINT_ADDRESS_V07, ENTRYPOINT_ADDRESS_V06 } from 'permissionless';
import { KERNEL_V3_1, KERNEL_V3_0, KERNEL_V2_4 } from '@zerodev/sdk/constants';
import { ProviderKernelVersionEnum } from '@dynamic-labs/sdk-api-core';
import { logger } from './logger.js';

const getKernelVersion = (kernelVersion, entryPointAddress) => {
    if (kernelVersion === ProviderKernelVersionEnum.V31 ||
        (kernelVersion === undefined &&
            entryPointAddress === ENTRYPOINT_ADDRESS_V07)) {
        return KERNEL_V3_1;
    }
    else if (kernelVersion === ProviderKernelVersionEnum.V30) {
        return KERNEL_V3_0;
    }
    else if (kernelVersion === ProviderKernelVersionEnum.V24 ||
        entryPointAddress === ENTRYPOINT_ADDRESS_V06 // v0.6 only supports v2.4
    ) {
        return KERNEL_V2_4;
    }
    else {
        logger.error('Invalid kernel version', kernelVersion);
        return KERNEL_V3_1;
    }
};

export { getKernelVersion };
