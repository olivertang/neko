'use client'
import { effect } from '@vue/reactivity';
import { createStore } from '@dynamic-labs/message-transport';
import { pickListenerActions } from '../../utils/pickListenerActions/pickListenerActions.js';
import { addProperty } from '../../utils/addProperty/addProperty.js';

const createSdkModule = (core) => {
    const store = createStore({
        initialState: {
            loaded: false,
        },
        key: 'sdk',
        messageTransport: core.messageTransport,
    });
    const eventEmitter = store.eventEmitter;
    const baseModule = Object.assign(store.getters, pickListenerActions(eventEmitter));
    effect(() => core.initialization.error, {
        scheduler: () => eventEmitter.emit('error', core.initialization.error),
    });
    return addProperty(baseModule, 'error', {
        get: () => core.initialization.error,
    });
};

export { createSdkModule };
