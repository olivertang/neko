'use client'
import { createRequestChannel, createEventEmitterForMessages, smsEventNames } from '@dynamic-labs/message-transport';
import { pickListenerActions } from '../../../utils/pickListenerActions/pickListenerActions.js';

const createSmsAuthModule = (core) => {
    const requestChannel = createRequestChannel(core.messageTransport);
    const messageEvents = createEventEmitterForMessages({
        eventNames: smsEventNames,
        messageTransport: core.messageTransport,
    });
    return Object.assign(pickListenerActions(messageEvents), {
        resendOTP: () => requestChannel.request('resendOTP'),
        sendOTP: (phone) => requestChannel.request('sendOTP', { destination: 'sms', target: phone }),
        verifyOTP: (token) => requestChannel.request('verifyOTP', token),
    });
};

export { createSmsAuthModule };
